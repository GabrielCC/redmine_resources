<%= text_field_tag(:resource, nil, :class => 'resources_autocomplete') %>
  <%= hidden_field_tag(:resource_id) %>
  
  <script type="text/javascript">
    $(document).ready(function() {
      <% resources.map! { |e| {:value => e.code, :label => e.code, :id => e.id} } %>
      window.get_resources_autocomplete_source = function() {
        return <%= raw resources.to_json %>;
      }

      $('.resources_autocomplete').autocomplete({
        source: window.get_resources_autocomplete_source(),
        select: function( event, ui ) {
          var id = $(this).attr('id');
              $( "#" + id ).val( ui.item.label );
              $( "#" + id + "_id" ).val( ui.item.id );
              return false;
            }
        });
    }); 
  </script>